from django.db import models

from django.utils import timezone
from datetime import datetime

class TrackingFields(models.Model):
	created = models.DateTimeField('Создан',auto_now_add=True)
	modified = models.DateTimeField('Изменён', auto_now=True)

	class Meta:
		abstract = False
		
class User(models.Model):
	login = models.CharField('Логин', max_length=255, unique=True,)
	key = models.CharField('Ключ', max_length=255,)
	#created = models.DateTimeField(
	#		verbose_name='Дата создания', auto_now_add=True, editable=False,)

	class Meta:
		ordering = ['login']
		abstract = True
		
	def __str__(self):
		return self.login
	
class PersonInfo(models.Model):
	name = models.CharField('Имя', max_length=255,)
	family = models.CharField('Фимилия', max_length=255,)
	surname = models.CharField('Отчество', max_length=255,)
	passportCode = models.CharField('пасcпорт', max_length=255,)
	address = models.TextField('место прописки',)

	class Meta:
		ordering = ['family']
		abstract = True	
		
	def __str__(self):
		return self.family + ' ' + self.name
	
class Owner(TrackingFields, User):
	class Meta:
		verbose_name = 'Владелец'
		verbose_name_plural = 'Владелецы'

		
class Cashier(TrackingFields, User, PersonInfo):
	#person = models.OneToOneField(PersonInfo, verbose_name='Личные данные', )
	class Meta:
		verbose_name = 'Кассир'
		verbose_name_plural = 'Кассиры'

	
class Client(TrackingFields, PersonInfo):
	#registered = models.DateTimeField(
			#verbose_name='Дата регистрации', auto_now_add=True, editable=False)
	class Meta:
		verbose_name = 'Клиент'
		verbose_name_plural = 'Клиенты'

		
class Pledge(TrackingFields):
	pledger = models.ForeignKey(Client, verbose_name="Залогодатель")
	acceptor = models.ForeignKey(User, verbose_name="Приемщик")
	
	price = models.PositiveIntegerField('Стоимость')
	term = models.PositiveIntegerField('Срок залога')

	class Meta:
		verbose_name = 'Залог'
		verbose_name_plural = 'Залоги'
	